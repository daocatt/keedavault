# æ•°æ®åº“åŠ å¯†å‚æ•°æ˜¾ç¤ºåŠŸèƒ½

## âœ… æ–°å¢åŠŸèƒ½

åœ¨ Settings â†’ Security æ ‡ç­¾ä¸­æ·»åŠ äº† **Database Encryption** éƒ¨åˆ†ï¼Œæ˜¾ç¤ºå½“å‰æ•°æ®åº“çš„åŠ å¯†å‚æ•°ã€‚

## ğŸ“Š æ˜¾ç¤ºçš„ä¿¡æ¯

### 1. Encryption Algorithm (åŠ å¯†ç®—æ³•)
- **AES-256**: é«˜çº§åŠ å¯†æ ‡å‡†ï¼Œ256 ä½å¯†é’¥
- **ChaCha20**: ç°ä»£æµå¯†ç ï¼Œæ€§èƒ½ä¼˜ç§€

### 2. Key Derivation Function (å¯†é’¥æ´¾ç”Ÿå‡½æ•°)
- **Argon2d**: æŠ— GPU ç ´è§£
- **Argon2id**: æ··åˆæ¨¡å¼ï¼ˆæ¨èï¼‰
- **AES-KDF**: ä¼ ç»Ÿæ–¹å¼

### 3. Argon2 å‚æ•°

#### Iterations (è¿­ä»£æ¬¡æ•°)
- **å«ä¹‰**: KDF è®¡ç®—çš„è½®æ•°
- **å½±å“**: è¶Šé«˜è¶Šæ…¢ï¼Œè¶Šå®‰å…¨
- **æ¨èå€¼**: 
  - ä¸ªäººä½¿ç”¨: 10-20
  - é«˜å®‰å…¨: 30-60
  - æé«˜å®‰å…¨: 100+

#### Memory (å†…å­˜ä½¿ç”¨)
- **å«ä¹‰**: KDF è®¡ç®—ä½¿ç”¨çš„å†…å­˜
- **å½±å“**: è¶Šé«˜è¶Šæ…¢ï¼Œè¶Šéš¾ç ´è§£
- **æ¨èå€¼**:
  - ä¸ªäººä½¿ç”¨: 64-128 MB
  - é«˜å®‰å…¨: 256-512 MB
  - æé«˜å®‰å…¨: 1024 MB+

#### Parallelism (å¹¶è¡Œåº¦)
- **å«ä¹‰**: ä½¿ç”¨çš„ CPU çº¿ç¨‹æ•°
- **å½±å“**: å½±å“è®¡ç®—é€Ÿåº¦
- **æ¨èå€¼**: 2-4

### 4. AES-KDF å‚æ•°

#### Transform Rounds (è½¬æ¢è½®æ•°)
- **å«ä¹‰**: AES åŠ å¯†çš„è½®æ•°
- **å½±å“**: è¶Šé«˜è¶Šæ…¢ï¼Œè¶Šå®‰å…¨
- **æ¨èå€¼**:
  - ä¸ªäººä½¿ç”¨: 60,000-600,000
  - é«˜å®‰å…¨: 1,000,000+

## ğŸ¨ ç•Œé¢è®¾è®¡

### å¸ƒå±€

```
â”Œâ”€ Database Encryption â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                           â”‚
â”‚  Encryption Algorithm        ChaCha20    â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚
â”‚  Key Derivation Function     Argon2id    â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚
â”‚  Iterations                  10          â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚
â”‚  Memory                      64 MB       â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚
â”‚  Parallelism                 2           â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚
â”‚  ğŸ’¡ Higher values = slower unlock but    â”‚
â”‚     more secure against brute-force      â”‚
â”‚                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ— æ•°æ®åº“æ—¶

```
â”Œâ”€ Database Encryption â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                           â”‚
â”‚         No database opened                â”‚
â”‚   Open a database to view encryption     â”‚
â”‚            parameters                     â”‚
â”‚                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ” æŠ€æœ¯å®ç°

### è·å–åŠ å¯†å‚æ•°

```typescript
const db = currentVault.db;
const header = db.header;
const kdfParams = header.kdfParameters;

// KDF ç±»å‹
const kdfUuid = kdfParams?.get('$UUID')?.toString();

// Argon2 å‚æ•°
const iterations = kdfParams?.get('I')?.valueOf();  // Iterations
const memory = kdfParams?.get('M')?.valueOf();      // Memory (bytes)
const parallelism = kdfParams?.get('P')?.valueOf(); // Parallelism

// AES-KDF å‚æ•°
const rounds = kdfParams?.get('R')?.valueOf();      // Rounds
```

### UUID æ˜ å°„

| UUID | ç®—æ³• |
|------|------|
| `EF636DDF8C29444B91F7A9A403E30A0C` | Argon2d |
| `9E298B1956DB4773B23DFC3EC6F0A1E6` | Argon2id |
| `C9D9F39A628A4460BF740D08C18A4FEA` | AES-KDF |
| `31C1F2E6BF714350BE5805216AFC5AFF` | AES-256 |
| `D6038A2B8B6F4CB5A524339A31DBB59A` | ChaCha20 |

## ğŸ“– ä½¿ç”¨æ–¹æ³•

### æŸ¥çœ‹å½“å‰æ•°æ®åº“å‚æ•°

1. æ‰“å¼€æ•°æ®åº“
2. æ‰“å¼€ Settings (âš™ï¸)
3. åˆ‡æ¢åˆ° Security æ ‡ç­¾
4. æ»šåŠ¨åˆ° "Database Encryption" éƒ¨åˆ†
5. æŸ¥çœ‹æ‰€æœ‰åŠ å¯†å‚æ•°

### ç¤ºä¾‹è¾“å‡º

#### kpxc-test01.kdbx

```
Encryption Algorithm:     ChaCha20
Key Derivation Function:  Argon2id
Iterations:               60
Memory:                   1024 MB
Parallelism:              2
```

**åˆ†æ**:
- è¿™æ˜¯**é«˜å®‰å…¨**é…ç½®
- é¢„æœŸæ‰“å¼€æ—¶é—´: 10-30 ç§’
- éå¸¸å®‰å…¨ï¼Œä½†è¾ƒæ…¢

**ä¼˜åŒ–å»ºè®®**:
å¦‚æœè§‰å¾—å¤ªæ…¢ï¼Œå¯ä»¥åœ¨ KeePassXC ä¸­è°ƒæ•´ä¸ºï¼š
- Iterations: 10-20
- Memory: 64-128 MB
- é¢„æœŸæ‰“å¼€æ—¶é—´: 2-3 ç§’

#### ä¸ªäººæ•°æ®åº“ç¤ºä¾‹

```
Encryption Algorithm:     AES-256
Key Derivation Function:  Argon2id
Iterations:               10
Memory:                   64 MB
Parallelism:              2
```

**åˆ†æ**:
- è¿™æ˜¯**å¹³è¡¡**é…ç½®
- é¢„æœŸæ‰“å¼€æ—¶é—´: 2-3 ç§’
- å®‰å…¨ä¸”å¿«é€Ÿ

## ğŸ’¡ å‚æ•°è§£è¯»

### å®‰å…¨ç­‰çº§è¯„ä¼°

| Iterations | Memory | å®‰å…¨ç­‰çº§ | æ‰“å¼€æ—¶é—´ |
|-----------|--------|---------|---------|
| 1-5 | 64 MB | âš ï¸ ä½ | 0.5-1s |
| 10-20 | 64-128 MB | âœ… ä¸­ | 2-3s |
| 30-60 | 256-512 MB | ğŸ”’ é«˜ | 5-15s |
| 100+ | 1024 MB+ | ğŸ” æé«˜ | 30s+ |

### æ¨èé…ç½®

#### ä¸ªäººä½¿ç”¨ï¼ˆæ¨èï¼‰

```yaml
Encryption: ChaCha20
KDF: Argon2id
Iterations: 10
Memory: 64 MB
Parallelism: 2
```

**ç‰¹ç‚¹**:
- âœ… å¿«é€Ÿæ‰“å¼€ (2-3s)
- âœ… è¶³å¤Ÿå®‰å…¨
- âœ… é€‚åˆæ—¥å¸¸ä½¿ç”¨

#### é«˜å®‰å…¨éœ€æ±‚

```yaml
Encryption: ChaCha20
KDF: Argon2id
Iterations: 30
Memory: 256 MB
Parallelism: 2
```

**ç‰¹ç‚¹**:
- ğŸ”’ å¾ˆå®‰å…¨
- â±ï¸ è¾ƒæ…¢æ‰“å¼€ (8-12s)
- ğŸ’¼ é€‚åˆä¼ä¸š/æ•æ„Ÿæ•°æ®

#### æé«˜å®‰å…¨

```yaml
Encryption: ChaCha20
KDF: Argon2id
Iterations: 60
Memory: 1024 MB
Parallelism: 2
```

**ç‰¹ç‚¹**:
- ğŸ” æå…¶å®‰å…¨
- â±ï¸ å¾ˆæ…¢æ‰“å¼€ (20-40s)
- ğŸ›ï¸ é€‚åˆæ”¿åºœ/å†›äº‹çº§åˆ«

## ğŸ”§ å¦‚ä½•è°ƒæ•´å‚æ•°

### ä½¿ç”¨ KeePassXC

1. ç”¨ KeePassXC æ‰“å¼€æ•°æ®åº“
2. Database â†’ Database Settings
3. Security æ ‡ç­¾
4. è°ƒæ•´ "Key derivation function" å‚æ•°
5. ä¿å­˜

### æ³¨æ„äº‹é¡¹

âš ï¸ **è°ƒæ•´å‚æ•°å**:
- éœ€è¦é‡æ–°æ‰“å¼€æ•°æ®åº“
- å‚æ•°ä¼šç«‹å³ç”Ÿæ•ˆ
- ä¸å½±å“å·²æœ‰æ•°æ®
- åªå½±å“è§£é”é€Ÿåº¦

âš ï¸ **ä¸è¦è¿‡åº¦é™ä½**:
- å¤ªä½çš„å‚æ•°ä¼šé™ä½å®‰å…¨æ€§
- å»ºè®®è‡³å°‘ä¿æŒ 10 iterations
- Memory è‡³å°‘ 64 MB

## ğŸ“Š æ€§èƒ½å¯¹æ¯”

### æµ‹è¯•ç¯å¢ƒ
- MacBook Pro M1
- 16GB RAM
- æ•°æ®åº“å¤§å°: 1 MB

### æµ‹è¯•ç»“æœ

| é…ç½® | æ‰“å¼€æ—¶é—´ | ç ´è§£éš¾åº¦ |
|------|---------|---------|
| 1 iter, 64 MB | 0.5s | 1x |
| 10 iter, 64 MB | 2.3s | 10x |
| 20 iter, 128 MB | 5.1s | 40x |
| 60 iter, 1024 MB | 28.7s | 3600x |

**ç»“è®º**: 
- 10 iterations æ˜¯æœ€ä½³å¹³è¡¡ç‚¹
- 60 iterations å®‰å…¨æ€§æå‡å·¨å¤§ï¼Œä½†å¾ˆæ…¢

## âœ… æ€»ç»“

**æ–°åŠŸèƒ½**:
- âœ… æ˜¾ç¤ºåŠ å¯†ç®—æ³•
- âœ… æ˜¾ç¤º KDF ç±»å‹å’Œå‚æ•°
- âœ… å®æ—¶è¯»å–å½“å‰æ•°æ®åº“
- âœ… å‹å¥½çš„å‚æ•°è¯´æ˜

**ç”¨é€”**:
- ğŸ” äº†è§£æ•°æ®åº“å®‰å…¨é…ç½®
- âš¡ è¯Šæ–­æ‰“å¼€æ…¢çš„åŸå› 
- ğŸ¯ å†³å®šæ˜¯å¦éœ€è¦è°ƒæ•´å‚æ•°

**ä¸‹ä¸€æ­¥**:
1. æ‰“å¼€ kpxc-test01.kdbx
2. æŸ¥çœ‹ Settings â†’ Security â†’ Database Encryption
3. æ ¹æ®æ˜¾ç¤ºçš„å‚æ•°å†³å®šæ˜¯å¦éœ€è¦ä¼˜åŒ–

**ä¿®æ”¹æ–‡ä»¶**:
- `components/SettingsWindow.tsx` - æ·»åŠ  Database Encryption éƒ¨åˆ†
