# å¤‡ä»½æ•°é‡è°ƒæ•´

## ğŸ“‹ æ›´æ–°å†…å®¹

å°†é»˜è®¤å¤‡ä»½æ•°é‡ä» **5 ä¸ª**è°ƒæ•´ä¸º **2 ä¸ª**ã€‚

## ğŸ¯ åŸå› 

- å‡å°‘ç£ç›˜ç©ºé—´å ç”¨
- 2 ä¸ªå¤‡ä»½å·²ç»è¶³å¤Ÿæä¾›æ•°æ®ä¿æŠ¤
- å¤§å¤šæ•°ç”¨æˆ·ä¸éœ€è¦ä¿ç•™å¤ªå¤šå†å²ç‰ˆæœ¬

## ğŸ“Š å½±å“

### ç£ç›˜ç©ºé—´èŠ‚çœ

å‡è®¾æ•°æ®åº“æ–‡ä»¶å¤§å°ä¸º 1 MBï¼š

| å¤‡ä»½æ•°é‡ | ç£ç›˜å ç”¨ | èŠ‚çœç©ºé—´ |
|---------|---------|---------|
| 5 ä¸ªï¼ˆæ—§ï¼‰| ~6 MB | - |
| 2 ä¸ªï¼ˆæ–°ï¼‰| ~3 MB | **50%** â†“ |

### ä¿æŠ¤èƒ½åŠ›

**2 ä¸ªå¤‡ä»½è¶³å¤Ÿ**:
- âœ… æœ€æ–°å¤‡ä»½ï¼šä¿å­˜å‰çš„ç‰ˆæœ¬
- âœ… æ¬¡æ–°å¤‡ä»½ï¼šä¸Šä¸€æ¬¡ä¿å­˜å‰çš„ç‰ˆæœ¬
- âœ… å¯ä»¥å›é€€åˆ°æœ€è¿‘ä¸¤ä¸ªçŠ¶æ€
- âœ… è¦†ç›–å¤§å¤šæ•°è¯¯æ“ä½œåœºæ™¯

## ğŸ”§ ä¿®æ”¹çš„ä½ç½®

### 1. VaultContext.tsx
```typescript
const result = await safeSaveDatabase(vault.path, vault.db, {
    createBackup: autoBackupEnabled,
    maxBackups: 2,  // ä» 5 æ”¹ä¸º 2
    verifyAfterWrite: true,
    silent: isAutoSave
});
```

### 2. databaseIntegrityService.ts
```typescript
const {
    createBackup = true,
    maxBackups = 2,  // é»˜è®¤å€¼ä» 5 æ”¹ä¸º 2
    verifyAfterWrite = true,
    silent = false
} = options;
```

### 3. SettingsWindow.tsx
```typescript
description="Automatically create backups before saving (keeps 2 most recent backups)"
// ä» "keeps 5 most recent backups" æ”¹ä¸º "keeps 2 most recent backups"
```

## ğŸ“ å¤‡ä»½æ¸…ç†ç¤ºä¾‹

### ä¿å­˜æµç¨‹

```
ç¬¬ 1 æ¬¡ä¿å­˜:
  vault.kdbx
  vault.backup.2025-12-12T19-00-00.kdbx  (1ä¸ªå¤‡ä»½)

ç¬¬ 2 æ¬¡ä¿å­˜:
  vault.kdbx
  vault.backup.2025-12-12T19-05-00.kdbx  (æœ€æ–°)
  vault.backup.2025-12-12T19-00-00.kdbx  (2ä¸ªå¤‡ä»½)

ç¬¬ 3 æ¬¡ä¿å­˜:
  vault.kdbx
  vault.backup.2025-12-12T19-10-00.kdbx  (æœ€æ–°)
  vault.backup.2025-12-12T19-05-00.kdbx  (ä¿ç•™)
  âŒ vault.backup.2025-12-12T19-00-00.kdbx  (è‡ªåŠ¨åˆ é™¤)
```

## ğŸ§ª æµ‹è¯•

### éªŒè¯å¤‡ä»½æ•°é‡

1. æ‰“å¼€æ•°æ®åº“
2. è¿ç»­ä¿å­˜ 3 æ¬¡
3. æ£€æŸ¥æ–‡ä»¶ç›®å½•
4. **é¢„æœŸ**: åªæœ‰ 2 ä¸ªå¤‡ä»½æ–‡ä»¶

```bash
ls -lht /path/to/database/*.backup.*.kdbx
# åº”è¯¥åªçœ‹åˆ° 2 ä¸ªæ–‡ä»¶
```

### éªŒè¯æ¸…ç†æ—¥å¿—

æµè§ˆå™¨æ§åˆ¶å°åº”è¯¥æ˜¾ç¤ºï¼š

```
[Backup Cleanup] Found 3 backup files total
[Backup Cleanup] Will delete 1 old backups (keeping 2)
[Backup Cleanup] âœ… Deleted: vault.backup.2025-12-12T19-00-00.kdbx
```

## ğŸ’¡ ç”¨æˆ·è‡ªå®šä¹‰

å¦‚æœç”¨æˆ·éœ€è¦ä¿ç•™æ›´å¤šå¤‡ä»½ï¼Œå¯ä»¥åœ¨ä»£ç ä¸­ä¿®æ”¹ï¼š

```typescript
// åœ¨ VaultContext.tsx ä¸­
maxBackups: 5,  // æ”¹ä¸º 5 æˆ–å…¶ä»–æ•°å­—
```

**æ¨èå€¼**:
- **1 ä¸ª** - æœ€å°ä¿æŠ¤
- **2 ä¸ª**ï¼ˆé»˜è®¤ï¼‰- å¹³è¡¡ç©ºé—´å’Œå®‰å…¨
- **3 ä¸ª** - æ›´å¤šå†å²
- **5 ä¸ª** - æœ€å¤§ä¿æŠ¤

## âœ… æ€»ç»“

**æ›´æ–°**:
- âœ… é»˜è®¤å¤‡ä»½æ•°é‡ï¼š5 â†’ 2
- âœ… ç£ç›˜ç©ºé—´èŠ‚çœï¼š~50%
- âœ… ä¿æŠ¤èƒ½åŠ›ï¼šä»ç„¶å……è¶³

**ç”¨æˆ·å—ç›Š**:
- ğŸ’¾ èŠ‚çœç£ç›˜ç©ºé—´
- âš¡ æ›´å¿«çš„å¤‡ä»½æ¸…ç†
- ğŸ¯ ä»æœ‰è¶³å¤Ÿçš„æ•°æ®ä¿æŠ¤
